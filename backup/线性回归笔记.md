
æœ¬æ–‡å‚è€ƒäº†å‘¨å¿—åè€å¸ˆçš„ã€Šæœºå™¨å­¦ä¹ ã€‹ï¼ˆä¿—ç§°â€œè¥¿ç“œä¹¦â€ï¼‰ã€‚è¿™é‡Œæ˜¯ **ç¬¬ä¸‰ç« â€œçº¿æ€§æ¨¡å‹â€** çš„é˜…è¯»ç¬”è®°ã€‚æœ¬æ–‡ä¸“æ³¨äº**çº¿æ€§å›å½’**è¿™ä¸€å—ï¼Œå¹¶ä¸”è®°å½•äº†æˆ‘çš„æ€è€ƒï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ğŸ‰


---

### ä¸€ã€**çº¿æ€§æ¨¡å‹åŸºæœ¬æ¦‚å¿µ**

çº¿æ€§æ¨¡å‹æ˜¯æœºå™¨å­¦ä¹ çš„åŸºç¡€æ¨¡å‹ä¹‹ä¸€ï¼Œå‡è®¾ç›®æ ‡å€¼ \(y\) ä¸è¾“å…¥ç‰¹å¾ \(x\) ä¹‹é—´çš„å…³ç³»æ˜¯ä¸€ä¸ªçº¿æ€§ç»„åˆã€‚


  ![çº¿æ€§å›å½’å›¾ç‰‡](https://i.ibb.co/cJdSvbr/image.png)


---

### äºŒã€**çº¿æ€§å›å½’å…¬å¼æ¨å¯¼**

ä¸ºäº†æ¨å¯¼å‡ºæœ€ä¼˜çš„ \(w\) å’Œ \(b\)ï¼Œæˆ‘ä»¬éœ€è¦æœ€å°åŒ–æŸå¤±å‡½æ•° \(L(w, b)\)ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´æ¨å¯¼è¿‡ç¨‹ï¼š

![çº¿æ€§å›å½’æ¨å¯¼](https://i.ibb.co/TY7Gbnh/image.png)

---

### ä¸‰ã€**ä»é›¶å®ç°çº¿æ€§å›å½’**

ä½¿ç”¨ Python å®Œå…¨ä»é›¶å®ç°çº¿æ€§å›å½’ï¼ŒåŒ…æ‹¬æ•°æ®ç”Ÿæˆã€è§£æè§£è®¡ç®—å’Œæ¨¡å‹é¢„æµ‹ã€‚

```python
import numpy as np

# 1. ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
np.random.seed(42)
m = 100  # æ ·æœ¬æ•°é‡
n = 1    # ç‰¹å¾æ•°é‡

X = 2 * np.random.rand(m, n)  # è¾“å…¥ç‰¹å¾çŸ©é˜µ
true_w = np.array([[3]])      # çœŸå®æƒé‡
true_b = 5                   # çœŸå®åç½®

y = X.dot(true_w) + true_b    # çœŸå®ç›®æ ‡å€¼
y += np.random.randn(m, 1)    # æ·»åŠ é«˜æ–¯å™ªå£°
```
![](https://i.ibb.co/vVnfs3q/image.png)
```python
# 2. å®ç°çº¿æ€§å›å½’è§£æè§£
def linear_regression(X, y):
    """å®ç°çº¿æ€§å›å½’è§£æè§£"""
    m = len(X)
    X_b = np.c_[X, np.ones((m, 1))]  # æ·»åŠ åç½®é¡¹ (X_b = [X, 1])
    theta = np.linalg.inv(X_b.T.dot(X_b)).dot(X_b.T).dot(y)  # è§£æè§£å…¬å¼
    return theta
```
![](https://i.ibb.co/gD3FWRb/image.png)


```python
# 3. è®¡ç®—æƒé‡å’Œåç½®
theta = linear_regression(X, y)
w_hat = theta[:-1]  # æƒé‡
b_hat = theta[-1]   # åç½®

print(f"çœŸå®æƒé‡: {true_w.flatten()}, é¢„æµ‹æƒé‡: {w_hat.flatten()}")
print(f"çœŸå®åç½®: {true_b}, é¢„æµ‹åç½®: {b_hat}")

# 4. é¢„æµ‹å‡½æ•°
def predict(X, w, b):
    return X.dot(w) + b

# 5. å¯è§†åŒ–ç»“æœ
import matplotlib.pyplot as plt
plt.rcParams['font.sans-serif'] = ['SimHei']  # ä½¿ç”¨é»‘ä½“
plt.rcParams['axes.unicode_minus'] = False   # è§£å†³è´Ÿå·æ˜¾ç¤ºé—®é¢˜


plt.scatter(X, y, color="blue", label="çœŸå®æ•°æ®")
y_pred = predict(X, w_hat, b_hat)
plt.plot(X, y_pred, color="red", label="æ‹Ÿåˆç›´çº¿")
plt.xlabel("ç‰¹å¾ X")
plt.ylabel("ç›®æ ‡ y")
plt.legend()
plt.title("çº¿æ€§å›å½’ï¼šä»é›¶å®ç°")
plt.show()
```

---

### å››ã€**ç»“æœåˆ†æ**

1. **è¾“å‡º**ï¼š

 ```
  çœŸå®æƒé‡: [3], é¢„æµ‹æƒé‡: [2.77011339]
çœŸå®åç½®: 5, é¢„æµ‹åç½®: [5.21509616]
 ```


3. **å›¾åƒè§£é‡Š**ï¼š
![çº¿æ€§å›å½’pythonå›¾](https://i.ibb.co/cbQgsvZ/1.png)

   - è“ç‚¹è¡¨ç¤ºçœŸå®æ•°æ®ï¼ˆåŒ…å«å™ªå£°ï¼‰ã€‚
   - çº¢çº¿è¡¨ç¤ºæˆ‘ä»¬ç”¨è§£æè§£æ‹Ÿåˆå‡ºçš„çº¿æ€§å›å½’æ¨¡å‹ã€‚

---

### äº”ã€å¤´è„‘é£æš´

#### 1.æ‰‹å†™ç‰ˆå…¬å¼æ¨å¯¼è¿‡ç¨‹

![](https://i.ibb.co/6t45rg2/image.png)

#### 2.å¯ä»¥åŠ å…¥æ¢¯åº¦ä¸‹é™æ¥ä¼˜åŒ–çº¿æ€§å›å½’

 **ç®€å•è§£é‡Š**
æ¢¯åº¦ä¸‹é™æ˜¯ä¸€ç§è¿­ä»£ä¼˜åŒ–ç®—æ³•ï¼Œç”¨äºé€šè¿‡ä¸æ–­è°ƒæ•´å‚æ•°)æ¥æœ€å°åŒ–æŸå¤±å‡½æ•°ã€‚ç›¸æ¯”è§£æè§£ï¼ˆç›´æ¥è®¡ç®—ï¼‰ï¼Œæ¢¯åº¦ä¸‹é™æ›´åŠ é€‚åˆå¤§è§„æ¨¡æ•°æ®é›†ï¼Œå› ä¸ºå®ƒé¿å…äº†çŸ©é˜µæ±‚é€†çš„é«˜è®¡ç®—æˆæœ¬ã€‚

**ä¸»è¦è¿‡ç¨‹**ï¼š
![](https://i.ibb.co/X8T3xnX/image.png)

**ä¼˜ç‚¹**ï¼š
- é€‚ç”¨äºå¤§è§„æ¨¡æ•°æ®ã€‚
- å¯ä»¥é€æ­¥é€¼è¿‘å…¨å±€æœ€ä¼˜è§£ã€‚

---

#### 3.æ­£åˆ™åŒ–ï¼ˆL1/L2ï¼‰å¤„ç†è¿‡æ‹Ÿåˆ

#### **ç®€å•è§£é‡Š**
æ­£åˆ™åŒ–é€šè¿‡åœ¨æŸå¤±å‡½æ•°ä¸­å¢åŠ ä¸€ä¸ªæƒ©ç½šé¡¹ï¼Œé™åˆ¶æ¨¡å‹å‚æ•°çš„å¤§å°ï¼Œä»è€Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚ä¸»è¦æœ‰ä¸¤ç§å½¢å¼ï¼š

![](https://i.ibb.co/wrtDfHZ/image.png)

**æ­£åˆ™åŒ–çš„æ„ä¹‰**ï¼š
- é˜²æ­¢æ¨¡å‹è¿‡åº¦æ‹Ÿåˆè®­ç»ƒæ•°æ®ã€‚
- æé«˜æ¨¡å‹å¯¹æ–°æ•°æ®çš„æ³›åŒ–èƒ½åŠ›ã€‚

---

#### 4.æ›´ç®€å•çš„ä»£ç æ˜¾ç¤º


**4.1. ä½¿ç”¨ PyTorch å®ç°çº¿æ€§å›å½’**

**ä»£ç å®ç°**

```python
import torch
import torch.nn as nn
import matplotlib.pyplot as plt
import numpy as np

# 1. ç”Ÿæˆæ•°æ®
np.random.seed(42)
X = 2 * np.random.rand(100, 1).astype(np.float32)
y = 3 * X + 5 + np.random.randn(100, 1).astype(np.float32)  # y = 3X + 5 + å™ªå£°

# è½¬æ¢ä¸º PyTorch å¼ é‡
X_tensor = torch.from_numpy(X)
y_tensor = torch.from_numpy(y)

# 2. å®šä¹‰æ¨¡å‹
class LinearRegressionModel(nn.Module):
    def __init__(self):
        super(LinearRegressionModel, self).__init__()
        self.linear = nn.Linear(1, 1)  # è¾“å…¥ç»´åº¦ 1ï¼Œè¾“å‡ºç»´åº¦ 1

    def forward(self, x):
        return self.linear(x)

# åˆ›å»ºæ¨¡å‹å®ä¾‹
model = LinearRegressionModel()

# 3. å®šä¹‰æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨
criterion = nn.MSELoss()  # å‡æ–¹è¯¯å·®æŸå¤±
optimizer = torch.optim.SGD(model.parameters(), lr=0.01)  # éšæœºæ¢¯åº¦ä¸‹é™

# 4. è®­ç»ƒæ¨¡å‹
epochs = 1000
losses = []

for epoch in range(epochs):
    # å‰å‘ä¼ æ’­
    y_pred = model(X_tensor)
    loss = criterion(y_pred, y_tensor)

    # åå‘ä¼ æ’­å’Œä¼˜åŒ–
    optimizer.zero_grad()
    loss.backward()
    optimizer.step()

    # è®°å½•æŸå¤±
    losses.append(loss.item())
    if epoch % 100 == 0:
        print(f"Epoch {epoch}, Loss: {loss.item():.4f}")

# 5. è·å–æƒé‡å’Œåç½®
w, b = model.linear.weight.item(), model.linear.bias.item()
print(f"é¢„æµ‹æƒé‡: {w:.2f}, é¢„æµ‹åç½®: {b:.2f}")

# 6. ç»“æœ
y_pred = model(X_tensor).detach().numpy()  # è·å–é¢„æµ‹å€¼

```

---

**4.2. ä½¿ç”¨ Scikit-learn å®ç°çº¿æ€§å›å½’ï¼ˆå¸¦æ­£åˆ™åŒ–ï¼‰**

**a. æ™®é€šçº¿æ€§å›å½’**

```python
from sklearn.linear_model import LinearRegression

# 1. åˆ›å»ºæ¨¡å‹å¹¶è®­ç»ƒ
model = LinearRegression()
model.fit(X, y)

# 2. è·å–æƒé‡å’Œåç½®
w_hat = model.coef_[0][0]
b_hat = model.intercept_[0]
print(f"é¢„æµ‹æƒé‡: {w_hat:.2f}, é¢„æµ‹åç½®: {b_hat:.2f}")

# 3. ç»“æœ
y_pred = model.predict(X)

```

---

**b. å¸¦æ­£åˆ™åŒ–çš„çº¿æ€§å›å½’ï¼ˆRidge å’Œ Lassoï¼‰**

 **Ridge å›å½’ï¼ˆL2 æ­£åˆ™åŒ–ï¼‰**
```python
from sklearn.linear_model import Ridge

# 1. åˆ›å»º Ridge æ¨¡å‹
ridge_model = Ridge(alpha=1.0)  # alpha æ§åˆ¶æ­£åˆ™åŒ–å¼ºåº¦
ridge_model.fit(X, y)

# 2. è·å–æƒé‡å’Œåç½®
w_hat = ridge_model.coef_[0][0]
b_hat = ridge_model.intercept_[0]
print(f"Ridge å›å½’é¢„æµ‹æƒé‡: {w_hat:.2f}, é¢„æµ‹åç½®: {b_hat:.2f}")

# 3. å¯ç»“æœ
y_pred_ridge = ridge_model.predict(X)

```

---

 **Lasso å›å½’ï¼ˆL1 æ­£åˆ™åŒ–ï¼‰**
```python
from sklearn.linear_model import Lasso

# 1. åˆ›å»º Lasso æ¨¡å‹
lasso_model = Lasso(alpha=0.1)  # alpha æ§åˆ¶æ­£åˆ™åŒ–å¼ºåº¦
lasso_model.fit(X, y)

# 2. è·å–æƒé‡å’Œåç½®
w_hat = lasso_model.coef_[0]
b_hat = lasso_model.intercept_
print(f"Lasso å›å½’é¢„æµ‹æƒé‡: {w_hat:.2f}, é¢„æµ‹åç½®: {b_hat:.2f}")

# 3. ç»“æœ
y_pred_lasso = lasso_model.predict(X)

```

---

 **æ€»ç»“**

| **æ¨¡å‹**        | **å·¥å…·**       | **æ­£åˆ™åŒ–ç±»å‹**    | **ç‰¹ç‚¹**                                     |
|------------------|----------------|-------------------|----------------------------------------------|
| æ™®é€šçº¿æ€§å›å½’    | Scikit-learn   | æ—                | ä¸é™åˆ¶å‚æ•°ï¼Œé€‚åˆæ— å™ªå£°æˆ–ä½ç»´æ•°æ®åœºæ™¯ã€‚        |
| Ridge å›å½’       | Scikit-learn   | L2 æ­£åˆ™åŒ–        | é™åˆ¶æƒé‡å¤§å°ï¼Œä½¿æ¨¡å‹æ›´å¹³æ»‘ï¼Œé€‚åˆé«˜ç»´åœºæ™¯ã€‚    |
| Lasso å›å½’       | Scikit-learn   | L1 æ­£åˆ™åŒ–        | ç‰¹å¾é€‰æ‹©æ•ˆæœå¥½ï¼Œå¯ä½¿éƒ¨åˆ†ç‰¹å¾æƒé‡ä¸º 0ã€‚        |
| è‡ªå®šä¹‰çº¿æ€§å›å½’   | PyTorch        | æ”¯æŒæ¢¯åº¦ä¸‹é™     | çµæ´»æ€§é«˜ï¼Œå¯æ‰©å±•åˆ°å¤æ‚æ·±åº¦å­¦ä¹ ä»»åŠ¡ã€‚          |

### æ–‡ç« å‚è€ƒ

- ã€Šæœºå™¨å­¦ä¹ ï¼ˆè¥¿ç“œä¹¦ï¼‰ã€‹
- éƒ¨åˆ†LaTeX å…¬å¼å€ŸåŠ©äº†AIçš„å¸®åŠ©

 
